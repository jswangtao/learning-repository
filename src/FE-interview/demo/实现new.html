<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      function _new(fn,...args) {
        // åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡
        const obj = {}
        // è®¾ç½®åŽŸåž‹ï¼Œä½¿__proto__æŒ‡å‘æž„é€ å‡½æ•°çš„åŽŸåž‹ï¼Œè¿™æ ·ï¼Œæ–°å¯¹åƒå°±å¯ä»¥è®¿é—®åˆ°æž„é€ å‡½æ•°åŽŸåž‹ä¸Šçš„å±žæ€§ä¸Žæ–¹æ³•
        obj.__proto__ = fn.prototype
        // æ”¹å˜thisæŒ‡å‘ï¼Œè¿™æ ·ï¼Œæ–°å¯¹è±¡å°±å¯ä»¥è®¿é—®æž„é€ å‡½æ•°çš„å±žæ€§å’Œæ–¹æ³•
        const result = fn.apply(obj, args)
        // å¦‚æžœè¿”å›žå€¼æ˜¯ä¸€ä¸ªå¯¹è±¡å°±è¿”å›žè¯¥å¯¹è±¡ï¼Œå¦åˆ™è¿”å›žæž„é€ å‡½æ•°çš„ä¸€ä¸ªå®žä¾‹å¯¹è±¡
        return result instanceof Object ? result : obj
      }

      function Fn(name) {
        this.name = name
        this.sayName = function () {
          console.log(this.name)
        }

        // è¿”å›žéžå¯¹è±¡
        // return 1

        // è¿”å›žå¯¹è±¡
        // return {
        //   name,
        //   sayName: this.sayName
        // }
      }

      Fn.prototype.say = function (msg) {
        console.log(`${this.name} ${msg}`)
      }

      // const fn = new Fn('Ksmith')
      const fn = _new(Fn, 'Ksmith')
      console.log('ðŸš€ðŸš€ðŸš€wimi======>>>fn',fn)
      fn.say('Hello World') // Ksmith Hello World
      fn.sayName() // Ksmith
      console.log(fn.name) // Ksmith
    </script>
  </body>
</html>
